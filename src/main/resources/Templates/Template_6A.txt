# TEMPLATE 6A -- Calcula a Variação Absoluta para uma empresa específica.
SELECT ?O1 ?variacaoAbsoluta WHERE {
    ?S1 P7 ?label .
    FILTER(REGEX(STR(?label), "#ENTIDADE_NOME#", "i"))

    ?S1 P1 ?SO1 . 
    ?SO1 P1 ?intermediario .
    ?intermediario P3 ?SO2 . 
    ?SO2 P5 ?S2 .
    ?S2 P6 "#DATA#"^^xsd:date .

    ?SO1 P2 ?codigo .   
    ?codigo P8 ?O1 .

    ?SO2 b3:precoAbertura ?abertura .
    ?SO2 b3:precoFechamento ?fechamento .
    
  
    BIND((?fechamento - ?abertura) AS ?variacaoAbsoluta)
}